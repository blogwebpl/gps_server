import { expect } from 'chai';
import getCRUD from './getCRUD';
import { initDb } from '../seed/seed';

const userPopulated = { 'name': 'Administrator', 'roles': [{ 'permissions': [{ 'columns': [{ 'key': 'name', 'label': 'Name', 'sortOrder': 2, 'sort': 'asc' }, { 'key': 'email', 'label': 'E-mail', 'sortOrder': 1, 'sort': 'asc' }, { 'key': 'selectedRole', 'label': 'Selected role', 'sortOrder': 3 }], 'fields': [{ 'key': 'name', 'label': 'Name', 'type': 'text', 'required': true }, { 'key': 'email', 'label': 'E-mail', 'type': 'email', 'required': true }], 'crud': 15, '_id': '5d0d0e7f16c6121f71bc8ceb', 'name': 'Users - full', 'collectionName': 'users', '__v': 0 }, { 'columns': [], 'fields': [], 'crud': 0, '_id': '5d0d0e7f16c6121f71bc8cec', 'name': 'Roles', 'collectionName': 'roles', '__v': 0 }, { 'columns': [{ 'key': 'name', 'label': 'Name', 'sortOrder': 1, 'sort': 'asc' }], 'fields': [{ 'key': 'name', 'label': 'Name', 'type': 'text', 'required': true }, { 'key': 'items', 'label': 'Items', 'type': 'multiselect', 'collectionName': 'menuItems', 'collectionField': 'label', 'required': false }], 'crud': 15, '_id': '5d0d0e7f16c6121f71bc8ced', 'name': 'Menu - full', 'collectionName': 'menus', '__v': 0 }], '_id': '5d0d0e7f16c6121f71bc8cee', 'name': 'Admin', 'menu': '5d0d0e7f16c6121f71bc8ce9', '__v': 0 }, { 'permissions': [{ 'columns': [], 'fields': [], 'crud': 0, '_id': '5d0d0e7f16c6121f71bc8cec', 'name': 'Roles', 'collectionName': 'roles', '__v': 0 }, { 'columns': [{ 'key': 'name', 'label': 'Name', 'sortOrder': 1, 'sort': 'asc' }], 'fields': [{ 'key': 'name', 'label': 'Name', 'type': 'text', 'required': true }, { 'key': 'items', 'label': 'Items', 'type': 'multiselect', 'collectionName': 'menuItems', 'collectionField': 'label', 'required': false }], 'crud': 15, '_id': '5d0d0e7f16c6121f71bc8ced', 'name': 'Menu - full', 'collectionName': 'menus', '__v': 0 }], '_id': '5d0d0e7f16c6121f71bc8cef', 'name': 'User', 'menu': '5d0d0e7f16c6121f71bc8cea', '__v': 0 }], '_id': '5d0d0e7f16c6121f71bc8cf0', 'email': 'admin@admin.admin', 'password': '$2b$10$GcImt5X64lCsqany.j60weSpg31p0UsNMiHWBbDI02Nsejg/iiBHu', 'selectedRole': { 'permissions': [{ 'columns': [{ 'key': 'name', 'label': 'Name', 'sortOrder': 2, 'sort': 'asc' }, { 'key': 'email', 'label': 'E-mail', 'sortOrder': 1, 'sort': 'asc' }, { 'key': 'selectedRole', 'label': 'Selected role', 'sortOrder': 3 }], 'fields': [{ 'key': 'name', 'label': 'Name', 'type': 'text', 'required': true }, { 'key': 'email', 'label': 'E-mail', 'type': 'email', 'required': true }], 'crud': 15, '_id': '5d0d0e7f16c6121f71bc8ceb', 'name': 'Users - full', 'collectionName': 'users', '__v': 0 }, { 'columns': [], 'fields': [], 'crud': 0, '_id': '5d0d0e7f16c6121f71bc8cec', 'name': 'Roles', 'collectionName': 'roles', '__v': 0 }, { 'columns': [{ 'key': 'name', 'label': 'Name', 'sortOrder': 1, 'sort': 'asc' }], 'fields': [{ 'key': 'name', 'label': 'Name', 'type': 'text', 'required': true }, { 'key': 'items', 'label': 'Items', 'type': 'multiselect', 'collectionName': 'menuItems', 'collectionField': 'label', 'required': false }], 'crud': 15, '_id': '5d0d0e7f16c6121f71bc8ced', 'name': 'Menu - full', 'collectionName': 'menus', '__v': 0 }], '_id': '5d0d0e7f16c6121f71bc8cee', 'name': 'Admin', 'menu': '5d0d0e7f16c6121f71bc8ce9', '__v': 0 }, 'settings': { 'users': { 'columns': [{ 'key': 'name', 'label': 'Name', 'sortOrder': 1, 'sort': 'asc' }, { 'key': 'email', 'label': 'E-mail', 'sortOrder': 2, 'sort': 'asc' }] } }, 'token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZDBkMGU3ZjE2YzYxMjFmNzFiYzhjZjAiLCJleHAiOjE1OTI2NzI3NjcsImlhdCI6MTU2MTEzNjc2N30.qZTIP5C3TD5p5XSQhoizASsei3U6Owebu_ouGVzdyoI' };

describe('functions/getCRUD.js', () => {
	before(async() => {
		await initDb();
	});
	it('should return crud', () => {
		const response = getCRUD(userPopulated, 'users');
		expect(response).to.equal(15);
	});
	it('should return 0', () => {
		const response = getCRUD(userPopulated, '');
		expect(response).to.equal(0);
	});
});
